# Claude AI Context Documentation

## Project Overview

**Project Name**: Network Manager - Automatische WiFi/LAN Verwaltung  
**Author**: dajuly20  
**Version**: 1.0.0  
**Date**: November 2025  
**Repository**: BashScripts/disableWifiOnWiredConnection  

## Project Description

Ein intelligentes Bash-Script zur automatischen Verwaltung von WiFi- und Ethernet-Verbindungen mit grafischer Benutzeroberfläche. Das System deaktiviert automatisch WiFi, wenn eine Ethernet-Verbindung aktiv ist, und aktiviert WiFi wieder, wenn Ethernet getrennt wird.

## Key Requirements (Original User Request)

1. **Netzwerkerkennung**: Script soll erkennen, wenn mehrere Netzwerkverbindungen bestehen
2. **Automatische Verwaltung**: 
   - Wenn LAN angeschlossen → WLAN deaktivieren
   - Wenn LAN keine Verbindung → WLAN aktivieren
3. **GUI-Interface**: Mit grafischen Prompts für Benutzerinteraktion
4. **Automatisierungsoption**: Checkbox "immer so" für automatische Ausführung ohne weitere Nachfragen

## File Structure

```
disableWifiOnWiredConnection/
├── network_manager.sh      # Main script (300+ lines)
├── install.sh             # Installation script
├── test.sh               # Test suite
├── init.sh               # Project initialization
├── README.md             # Full documentation
├── PSEUDOCODE_README.md  # Technical architecture docs
├── .claude.md            # This file
├── CHANGELOG.md          # Version history
├── LICENSE              # MIT License
├── .gitignore           # Git ignore rules
├── config/              # Configuration examples
├── docs/                # Additional documentation
├── examples/            # Usage examples
├── logs/               # Log files directory
└── backup/             # Backup directory
```

## Core Technologies & Dependencies

- **Shell**: Bash
- **Network Management**: NetworkManager (nmcli)
- **GUI Frameworks**: Zenity (primary), KDialog (fallback)
- **Configuration**: INI-style config files
- **Desktop Integration**: .desktop files, autostart
- **Logging**: Text-based logging to /tmp/

## Architecture Summary

### Main Components

1. **Network Detection Engine** (`get_ethernet_status()`, `get_wifi_status()`)
   - Uses `nmcli` to query NetworkManager
   - Detects active ethernet connections
   - Monitors WiFi radio state

2. **Decision Logic** (`manage_connections()`)
   - Ethernet connected + WiFi enabled → Disable WiFi
   - Ethernet disconnected + WiFi disabled → Enable WiFi
   - Otherwise → No action

3. **GUI Interface** (`show_gui()`)
   - Cross-platform support (Zenity/KDialog)
   - Interactive forms with checkbox for automation
   - Status and error dialogs

4. **Configuration Management**
   - User config: `~/.config/network_manager_config`
   - Autostart: `~/.config/autostart/network_manager.desktop`
   - Persistent automation settings

5. **Daemon Mode** (`daemon_mode()`)
   - Background monitoring every 5 seconds
   - Automatic execution when enabled
   - Silent operation

### Command Line Interface

```bash
network-manager                # Interactive GUI mode
network-manager --daemon       # Background daemon
network-manager --status       # Show current status
network-manager --enable-auto  # Enable automation
network-manager --disable-auto # Disable automation
network-manager --manual       # One-time execution
network-manager --help         # Show help
```

## Key Features Implemented

### ✅ Core Functionality
- [x] Intelligent network connection detection
- [x] Automatic WiFi management based on Ethernet status
- [x] GUI interface with user prompts
- [x] "Always do this" checkbox for automation
- [x] Daemon mode for background operation

### ✅ User Experience
- [x] Cross-platform GUI support (Zenity/KDialog)
- [x] Clear status messages and error handling
- [x] Desktop menu integration
- [x] Autostart functionality
- [x] Comprehensive help system

### ✅ System Integration
- [x] NetworkManager integration
- [x] Desktop environment compatibility
- [x] User-level configuration (no root required)
- [x] Logging and debugging support
- [x] Installation and uninstallation scripts

### ✅ Development & Maintenance
- [x] Modular, well-documented code
- [x] Comprehensive test suite
- [x] Multiple installation methods
- [x] Version control ready
- [x] Example configurations

## Technical Implementation Details

### Network Detection Logic

```bash
# Ethernet status detection
nmcli -t -f NAME,TYPE,STATE connection show --active | grep ethernet | grep activated

# WiFi radio state
nmcli radio wifi  # Returns: enabled/disabled
```

### GUI Implementation Strategy

1. **Tool Detection**: Check for zenity → kdialog → console fallback
2. **Form Creation**: Use appropriate toolkit for user interaction
3. **Checkbox Handling**: Capture automation preference
4. **Error Display**: Show appropriate message types

### Configuration Architecture

- **File Format**: Simple KEY=VALUE pairs
- **Location**: User config directory (`~/.config/`)
- **Persistence**: Automatic save/load on operations
- **Backup**: Configuration stored in version control

### Automation Implementation

1. **Config Storage**: User preference saved to config file
2. **Autostart Entry**: Desktop file created for login automation
3. **Daemon Process**: Background monitoring with configurable intervals
4. **State Management**: Tracks last action to prevent unnecessary changes

## Testing Strategy

The test suite (`test.sh`) validates:

1. **Dependency Checking**: Verify required tools are installed
2. **Function Testing**: Test script parameters and basic functionality
3. **Network Status**: Read-only testing of network detection
4. **Configuration**: Validate config file handling
5. **Simulation**: Safe testing without actual network changes

## Installation Methods

1. **Automated Installation**: `sudo ./install.sh` (system-wide)
2. **User Installation**: `./install.sh` (local to user)
3. **Manual Installation**: Copy files to appropriate directories
4. **Package Installation**: Ready for packaging (deb, rpm, etc.)

## Common Use Cases & Workflows

### First-Time Setup
```bash
./init.sh          # Initialize project
./test.sh          # Validate system
sudo ./install.sh  # Install system-wide
network-manager    # Run with GUI
```

### Daily Usage
- **Manual**: Run `network-manager` when needed
- **Automatic**: Enable automation via checkbox, runs in background
- **Status Check**: Use `network-manager --status`

### Troubleshooting
- Check logs: `/tmp/network_manager.log`
- Validate config: `~/.config/network_manager_config`
- Test dependencies: `./test.sh`
- Reset config: Delete config files and restart

## Development Notes for Claude AI

### Code Style & Patterns
- Consistent function naming with snake_case
- Comprehensive error handling with meaningful messages
- Color-coded terminal output for better UX
- Modular design with single-responsibility functions
- Extensive logging for debugging

### Configuration Management
- User-centric approach (no system-wide configs required)
- Simple file formats for easy manual editing
- Automatic migration handling (future versions)
- Validation of user inputs

### Cross-Platform Considerations
- Multiple GUI toolkit support with graceful fallback
- Distribution-agnostic dependency detection
- Standard Linux directory conventions
- NetworkManager as universal Linux networking solution

### Security Considerations
- Runs in user context (no unnecessary privilege escalation)
- No sensitive data storage
- Safe command execution with proper quoting
- Input validation for all user inputs

## Future Enhancement Ideas

### Potential Features
- [ ] Network profile management (work, home, etc.)
- [ ] VPN integration
- [ ] Mobile hotspot management
- [ ] Power management integration
- [ ] Advanced scheduling (time-based rules)

### Technical Improvements
- [ ] Configuration GUI
- [ ] System tray integration
- [ ] DBus integration for better desktop integration
- [ ] Multiple network interface support
- [ ] Custom notification system

### Packaging & Distribution
- [ ] Debian package creation
- [ ] RPM package support
- [ ] AUR package for Arch Linux
- [ ] Snap package
- [ ] Flatpak support

## Known Limitations & Workarounds

1. **NetworkManager Dependency**: Requires NetworkManager (not network-manager)
   - Workaround: Detection and clear installation instructions

2. **GUI Toolkit Requirement**: Needs zenity or kdialog
   - Workaround: Fallback detection and console mode option

3. **User Permissions**: Some systems require netdev group membership
   - Workaround: Clear error messages with instructions

4. **Desktop Environment**: Autostart depends on DE support
   - Workaround: Manual daemon startup instructions

## Project Context for AI Assistance

This project demonstrates a complete solution for automated network management with:
- User requirement analysis and implementation
- Cross-platform compatibility considerations  
- Professional documentation and testing
- Real-world deployment scenarios
- Maintenance and support considerations

The codebase is production-ready with comprehensive error handling, user feedback, and installation procedures. It serves as an example of bash scripting best practices for system automation tasks.

---

**Note**: This documentation is maintained alongside the codebase and should be updated when significant changes are made to the project structure or functionality.